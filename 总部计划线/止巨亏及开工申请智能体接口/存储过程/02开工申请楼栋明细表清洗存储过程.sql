USE [HighData_prod]
GO
/****** Object:  StoredProcedure [dbo].[usp_s_集团开工申请楼栋明细表智能体数据提取]    Script Date: 2025/9/25 15:17:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- 集团开工申请楼栋明细表智能体数据提取表结构
-- 用于存储各公司、项目、楼栋的开工、销售、成本、利润等明细数据，便于智能体分析与决策

-- CREATE TABLE s_集团开工申请楼栋明细表智能体数据提取
-- (
--     公司名称                  VARCHAR(200),         -- 公司名称
--     公司GUID                  UNIQUEIDENTIFIER,     -- 公司唯一标识
--     项目名称                  VARCHAR(200),         -- 项目名称
--     项目GUID                  UNIQUEIDENTIFIER,     -- 项目唯一标识
--     业态                      VARCHAR(200),         -- 业态类型（如住宅、商业等）
--     状态                      VARCHAR(200),         -- 楼栋状态（如已售罄、在售等）
--     产品楼栋                  VARCHAR(200),         -- 产品楼栋名称
--     产品楼栋GUID              UNIQUEIDENTIFIER,     -- 产品楼栋唯一标识
--     赛道标签                  VARCHAR(200),         -- 赛道标签（如高端、刚需等）
--     实际售罄时间              DATETIME,             -- 实际售罄时间
--     历史供货周期              DECIMAL(38,10),       -- 历史供货周期（单位：月/天，具体业务定义）
--     总可售面积                DECIMAL(38,10),       -- 楼栋总可售面积（平方米）
--     总货值                    DECIMAL(38,10),       -- 楼栋总货值（万元/元，具体业务定义）
--     已开工未售部分的货值_含税  DECIMAL(38,10),       -- 已开工未售部分的货值（含税）
--     已开工未售部分的货值_不含税 DECIMAL(38,10),      -- 已开工未售部分的货值（不含税）
--     已开工未售部分的面积      DECIMAL(38,10),       -- 已开工未售部分的面积
--     已开工未售部分的销售均价  DECIMAL(38,10),       -- 已开工未售部分的销售均价
--     已售部分的含税货值        DECIMAL(38,10),       -- 已售部分的货值（含税）
--     已售部分的销售均价        DECIMAL(38,10),       -- 已售部分的销售均价
--     已售面积                  DECIMAL(38,10),       -- 已售面积
--     已推面积                  DECIMAL(38,10),       -- 已推面积
--     已售部分的推货去化率      DECIMAL(18,6),        -- 已售部分的推货去化率（已售面积/已推面积）
--     累计不含税签约金额        DECIMAL(38,10),       -- 累计不含税签约金额
--     业态所有支出的单方_含税费 DECIMAL(38,10),       -- 业态所有支出的单方（含税费）
--     不含税成本                DECIMAL(38,10),       -- 不含税成本
--     税后净利润                DECIMAL(38,10),       -- 税后净利润
--     销净率                    DECIMAL(18,6),        -- 销净率（已售面积/总可售面积）
--     清洗日期                  DATETIME              -- 数据清洗日期
-- )

-- -- 创建主键索引（产品楼栋GUID作为主键，因为它是楼栋的唯一标识）
-- CREATE INDEX IX_公司项目楼栋 ON s_集团开工申请楼栋明细表智能体数据提取 (公司GUID, 项目GUID, 产品楼栋GUID)
-- CREATE INDEX IX_清洗日期 ON s_集团开工申请楼栋明细表智能体数据提取 (清洗日期)

-- -- 1.1 集团止巨亏智能数据提取清洗
-- exec usp_s_集团止巨亏智能数据提取
-- -- 1.3 集团开工申请楼栋明细表智能体数据提取清洗
-- exec usp_s_集团开工申请楼栋明细表智能体数据提取

-- ============================================
-- 存储过程：usp_s_集团开工申请楼栋明细表智能体数据提取
-- 作用：提取开工申请楼栋明细表的基础数据，当前仅做字段结构占位，后续可完善字段取值逻辑
-- ============================================
CREATE OR ALTER PROC [dbo].[usp_s_集团开工申请楼栋明细表智能体数据提取]
AS
BEGIN
    
    /***********************************************************************
    步骤1：从源表提取数据，生成临时表#ld
    说明：
        - 仅“业态”和“产品楼栋GUID”等部分字段有实际取值，其余字段为NULL占位
        - 后续可在此基础上完善字段的实际取值逻辑
    ***********************************************************************/
    SELECT
        F056.平台公司 AS 公司名称,                -- 平台公司名称
        F056.orgGUID AS 公司GUID,                -- 公司唯一标识（GUID）
        F056.项目名称 AS 项目名称,               -- 项目名称
        p.ParentGUID AS 项目GUID,                -- 项目唯一标识（GUID）
        F056.项目推广名 as 推广名称,
        F056.业态组合键,
        F056.产品类型,
        F056.产品名称,
        F056.商品类型,
        F056.装修标准,

        -- 业态类型归类：住宅、车位、商办
        CASE 
            WHEN F056.产品类型 IN ('住宅', '高级住宅', '别墅') THEN '住宅'
            WHEN F056.产品类型 = '地下室/车库' THEN '车位'
            ELSE '商办'
        END AS 业态,                             -- 业态类型（如住宅、商业等）

        /*******************************************************************
        楼栋状态判断逻辑：
            - 剔除停工、缓建楼栋，仅保留正常楼栋
            - ① 未开工：实际开工完成日期为空
            - ② 开工未达预售：实际开工完成日期不为空，且达到预售形象完成日期为空
            - ③ 已达预售未推：达到预售形象完成日期不为空，且预售办理完成日期为空
            - ④ 已推：预售办理完成日期不为空
        *******************************************************************/
        CASE 
            WHEN isnull(F056.是否停工,'') IN ('停工', '缓建') OR  F056.实际开工完成日期 IS NULL THEN '未开工'
            WHEN isnull(F056.是否停工,'') NOT IN ('停工', '缓建') AND F056.实际开工完成日期 IS NOT NULL AND F056.达到预售形象完成日期 IS NULL THEN '开工未达预售'
            WHEN isnull(F056.是否停工,'') NOT IN ('停工', '缓建') AND F056.达到预售形象完成日期 IS NOT NULL AND F056.预售办理完成日期 IS NULL THEN '已达预售未推'
            WHEN isnull(F056.是否停工,'') NOT IN ('停工', '缓建') AND F056.预售办理完成日期 IS NOT NULL THEN '已推'
        END AS 状态,                             -- 楼栋状态（如已售罄、在售等）

        F056.产品楼栋名称 AS 产品楼栋,            -- 产品楼栋名称
        F056.SaleBldGUID AS 产品楼栋GUID,         -- 产品楼栋唯一标识（GUID）
        F056.赛道图标签 AS 赛道标签,              -- 赛道标签（如高端、刚需等）

       --  NULL AS 实际售罄时间,                     -- 实际售罄时间（预留，后续完善）

        -- 历史供货周期：楼栋实际达预售形象汇报完成时间 - 楼栋实际开工汇报完成时间，单位：月
       
        CASE 
            WHEN F056.达到预售形象完成日期 IS NOT NULL 
                 AND F056.实际开工完成日期 IS NOT NULL 
            THEN DATEDIFF(MONTH, F056.实际开工完成日期, F056.达到预售形象完成日期)
        END AS 历史供货周期,                      -- 历史供货周期，单位：月

        -- 以下字段为占位，后续可补充实际取值逻辑
        F056.可售面积 AS 总可售面积,                       -- 楼栋总可售面积（平方米）
        F056.动态总货值 AS 总货值,                           -- 楼栋总货值（万元/元，具体业务定义）
        case when F056.是否停工 NOT IN ('停工', '缓建') AND F056.实际开工完成日期 IS NOT NULL then F056.待售货值 end AS 已开工未售部分的货值_含税,         -- 已开工未售部分的货值（含税）
        case when F056.是否停工 NOT IN ('停工', '缓建') AND F056.实际开工完成日期 IS NOT NULL then F056.未售货值不含税 end AS 已开工未售部分的货值_不含税,       -- 已开工未售部分的货值（不含税）
        case when F056.是否停工 NOT IN ('停工', '缓建') AND F056.实际开工完成日期 IS NOT NULL then F056.待售面积 end AS 已开工未售部分的建筑面积,             -- 已开工未售部分的面积
        -- 已开工未售部分的销售均价,         -- 已开工未售部分的销售均价
        F056.已售货值 AS 已售部分的含税货值,               -- 已售部分的货值（含税）
        --  NULL AS 已售部分的销售均价,               -- 已售部分的销售均价
        F056.已售面积 AS 已售面积,                         -- 已售面积
        case when  F056.是否停工 NOT IN ('停工', '缓建') AND F056.预售办理完成日期 IS NOT NULL then F056.总可售面积 end  AS 已推面积,                         -- 已推面积
        -- NULL AS 已售部分的推货去化率,             -- 已售部分的推货去化率（已售面积/已推面积）
        F056.已售货值不含税 AS 累计不含税签约金额,             -- 累计不含税签约金额
        F056.已售净利润签约 as 已售净利润签约
        -- NULL AS 业态所有支出的单方_含税费,         -- 业态所有支出的单方（含税费）
        -- NULL AS 不含税成本,                       -- 不含税成本
        -- NULL AS 税后净利润,                       -- 税后净利润
        -- NULL AS 销净率                            -- 销净率（已售面积/总可售面积）
    INTO #ld
    FROM data_wide_dws_qt_F05601 F056
    INNER JOIN data_wide_dws_mdm_Project p 
        ON F056.ProjGUID = p.projguid            -- 关联分期GUID，获取项目信息

    --  计算楼栋的最后一套房间的签约日期
     SELECT BldGUID,lastQyDate,TotalRoomCount,QyRoomCount
     into #LastQyDate
     FROM (
         SELECT 
             BldGUID,
             MAX(
                 CASE 
                     WHEN Status = '签约' AND specialFlag <> '是' THEN QSDate
                     when Status = '签约'  then ISNULL(TsRoomQSDate, QSDate) 
                 END
             ) AS lastQyDate,
             COUNT(1) AS TotalRoomCount,
             SUM(CASE WHEN Status = '签约' THEN 1 ELSE 0 END) AS QyRoomCount
         FROM data_wide_s_RoomoVerride
         GROUP BY BldGUID
     ) salebld
     WHERE ISNULL(salebld.TotalRoomCount, 0) > 0 
       AND ISNULL(salebld.TotalRoomCount, 0) = ISNULL(salebld.QyRoomCount, 0)



    /***********************************************************************
    步骤1：提取M002表中楼栋对应业态组合键的相关数据
    说明：
        - 业态组合键由“产品类型+产品名称+商品类型+装修标准”拼接而成
        - 主要用于后续楼栋业态成本、费用等指标的匹配
        - 仅提取versionType为“累计版”的数据
        - 相关字段涵盖成本、利润、面积、签约/认购等多维度
    ***********************************************************************/
    SELECT 
        [OrgGuid],                        -- 平台公司GUID
        [ProjGUID],                       -- 项目GUID
        [versionguid],                    -- 版本GUID
        [产品类型],                        -- 产品类型
        [产品名称],                        -- 产品名称
        [除地外直投_单方],                  -- 除地价外直投（含税）单方成本
        [当期签约金额],                    -- 当期签约金额（含税）
        [当期签约金额不含税],              -- 当期签约金额（不含税）
        [当期签约面积],                    -- 当期签约面积
        [当期签约套数],                    -- 当期签约套数
        [当期认购金额],                    -- 当期认购金额（含税）
        [当期认购金额不含税],              -- 当期认购金额（不含税）
        [当期认购面积],                    -- 当期认购面积
        [当期认购套数],                    -- 当期认购套数
        [净利润签约],                      -- 签约口径净利润
        [净利润认购],                      -- 认购口径净利润
        [开发间接费单方],                  -- 开发间接费单方
        [毛利率签约],                      -- 签约口径毛利率
        [毛利率认购],                      -- 认购口径毛利率
        [毛利签约],                        -- 签约口径毛利额
        [毛利认购],                        -- 认购口径毛利额
        [明源匹配主键],                    -- 明源系统匹配主键
        [平台公司],                        -- 平台公司名称
        [商品类型],                        -- 商品类型
        [税前利润签约],                    -- 签约口径税前利润
        [税前利润认购],                    -- 认购口径税前利润
        [所得税签约],                      -- 签约口径所得税
        [所得税认购],                      -- 认购口径所得税
        [投管代码],                        -- 投管代码
        [土地款_单方],                     -- 土地款单方
        [推广名],                          -- 推广名
        [项目代码],                        -- 项目代码
        [项目名],                          -- 项目名称
        [销售净利率签约],                  -- 签约口径销售净利率
        [销售净利率认购],                  -- 认购口径销售净利率
        [业态组合键],                      -- 业态组合键（产品类型+产品名称+商品类型+装修标准）
        [盈利规划股权溢价单方],            -- 盈利规划股权溢价单方
        [盈利规划股权溢价签约],            -- 盈利规划股权溢价签约
        [盈利规划股权溢价认购],            -- 盈利规划股权溢价认购
        [盈利规划上线方式],                -- 盈利规划上线方式
        [盈利规划税金及附加单方],          -- 盈利规划税金及附加单方
        [盈利规划税金及附加签约],          -- 盈利规划税金及附加签约
        [盈利规划税金及附加认购],          -- 盈利规划税金及附加认购
        [盈利规划营销费用单方],            -- 盈利规划营销费用单方
        [盈利规划营销费用签约],            -- 盈利规划营销费用签约
        [盈利规划营销费用认购],            -- 盈利规划营销费用认购
        [盈利规划营业成本单方],            -- 盈利规划营业成本单方
        [盈利规划营业成本签约],            -- 盈利规划营业成本签约
        [盈利规划营业成本认购],            -- 盈利规划营业成本认购
        [盈利规划综合管理费单方协议口径],  -- 盈利规划综合管理费单方（协议口径）
        [盈利规划综合管理费签约],          -- 盈利规划综合管理费签约
        [盈利规划综合管理费认购],          -- 盈利规划综合管理费认购
        [装修标准],                        -- 装修标准
        [资本化利息单方],                  -- 资本化利息单方
        [StartTime],                       -- 数据开始时间
        [EndTime],                         -- 数据结束时间
        [ApproverState],                   -- 审批状态
        [versionType],                     -- 版本类型（此处仅取“累计版”）
        [当期产成品签约金额],              -- 当期产成品签约金额
        [当期产成品签约金额不含税],        -- 当期产成品签约金额（不含税）
        [产成品净利润签约],                -- 产成品净利润签约
        [产成品销售净利率签约]             -- 产成品销售净利率签约
    INTO #M002
    FROM data_wide_dws_qt_M002项目业态级毛利净利表
    WHERE versionType = '累计版'

    /***********************************************************************
    步骤2：删除当日已存在的数据，避免重复插入
    说明：
        - 以清洗日期为准，删除当天已存在的数据
    ***********************************************************************/
    DELETE FROM s_集团开工申请楼栋明细表智能体数据提取
    WHERE DATEDIFF(DAY, 清洗日期, GETDATE()) = 0

    /***********************************************************************
    步骤3：插入新提取的数据到目标表，并补充清洗日期
    说明：
        - 将临时表#ld中的数据插入目标表
        - 清洗日期为当前系统时间
    ***********************************************************************/
    -- 插入楼栋明细数据到目标表，字段含义见下方注释
    INSERT INTO s_集团开工申请楼栋明细表智能体数据提取
    (
        公司名称,                -- 公司名称
        公司GUID,                -- 公司唯一标识
        项目名称,                -- 项目名称
        推广名称,                -- 项目推广名 
        项目GUID,                -- 项目唯一标识
        业态,                    -- 业态类型
        产品类型,
        产品名称,
        状态,                    -- 当前状态
        产品楼栋,                -- 产品楼栋名称
        产品楼栋GUID,            -- 产品楼栋唯一标识
        赛道标签,                -- 赛道标签
        实际售罄时间,            -- 实际售罄时间
        历史供货周期,            -- 历史供货周期
        总可售面积,              -- 总可售面积
        总货值,                  -- 总货值
        已开工未售部分的货值_含税,    -- 已开工未售部分的货值（含税）
        已开工未售部分的货值_不含税,  -- 已开工未售部分的货值（不含税）
        已开工未售部分的建筑面积,        -- 已开工未售部分的建筑面积
        已开工未售部分的销售均价,    -- 已开工未售部分的销售均价
        已售部分的含税货值,          -- 已售部分的含税货值
        已售部分的销售均价,          -- 已售部分的销售均价
        已售面积,                  -- 已售面积
        已推面积,                  -- 已推面积
        已售部分的推货去化率,        -- 已售部分的推货去化率
        累计不含税签约金额,          -- 累计不含税签约金额
        业态所有支出的单方_含税费,    -- 业态所有支出的单方（含税费）
        不含税成本,                -- 不含税成本
        税后净利润,                -- 税后净利润（预留，当前为null）
        销净率,                    -- 销净率（预留，当前为null）
        清洗日期                   -- 数据清洗日期
    )
    SELECT
        -- 公司相关信息
        ld.公司名称,                  -- 公司名称
        ld.公司GUID,                  -- 公司唯一标识
        -- 项目相关信息
        ld.项目名称,                  -- 项目名称
        ld.推广名称,
        ld.项目GUID,                  -- 项目唯一标识
        ld.业态,                      -- 业态类型
        ld.产品类型,
        ld.产品名称,
        ld.状态,                      -- 当前状态
        -- 楼栋相关信息
        ld.产品楼栋,                  -- 产品楼栋名称
        ld.产品楼栋GUID,              -- 产品楼栋唯一标识
        ld.赛道标签,                  -- 赛道标签
        lqy.lastQyDate as 实际售罄时间,              -- 实际售罄时间
        case when bhqd.SaleBldGUID is null then ld.历史供货周期 else bhqd.最终历史供货周期 end as 历史供货周期,              -- 历史供货周期
        -- 面积与货值
        ld.总可售面积,                -- 总可售面积
        ld.总货值 /10000.0 as 总货值,                    -- 总货值
        ld.已开工未售部分的货值_含税 /10000.0 as 已开工未售部分的货值_含税, -- 已开工未售部分的货值（含税）
        ld.已开工未售部分的货值_不含税 /10000.0 as 已开工未售部分的货值_不含税, -- 已开工未售部分的货值（不含税）
        ld.已开工未售部分的建筑面积,      -- 已开工未售部分的建筑面积

        -- 计算已开工未售部分的销售均价
        -- 若“已开工未售部分的面积”为0，则销售均价为0，否则为“已开工未售部分的货值_含税”/“已开工未售部分的面积”
        CASE 
            WHEN ISNULL(ld.已开工未售部分的建筑面积, 0) = 0 THEN 0
            ELSE ISNULL(ld.已开工未售部分的货值_含税, 0) / ISNULL(ld.已开工未售部分的建筑面积, 0)
        END AS 已开工未售部分的销售均价,

        ld.已售部分的含税货值 /10000.0 as 已售部分的含税货值,        -- 已售部分的含税货值

        -- 计算已售部分的销售均价
        -- 若“已售面积”为0，则销售均价为0，否则为“已售部分的含税货值”/“已售面积”
        CASE 
            WHEN ISNULL(ld.已售面积, 0) = 0 THEN 0
            ELSE ISNULL(ld.已售部分的含税货值, 0) / ISNULL(ld.已售面积, 0)
        END AS 已售部分的销售均价,

        ld.已售面积,                  -- 已售面积
        ld.已推面积,                  -- 已推面积

        -- 计算已售部分的推货去化率
        -- 若“已推面积”为0，则去化率为0，否则为“已售面积”/“已推面积”
        CASE 
            WHEN ISNULL(ld.已推面积, 0) = 0 THEN 0
            ELSE ISNULL(ld.已售面积, 0) / ISNULL(ld.已推面积, 0)
        END *100 AS 已售部分的推货去化率,  -- 已售面积/已推面积

        ld.累计不含税签约金额 /10000.0 as 累计不含税签约金额,        -- 累计不含税签约金额

        -- 业态所有支出的单方_含税费
        -- 由各项单方费用求和，若某项为NULL则按0处理
        (
            ISNULL(m002.盈利规划营业成本单方, 0) +
            ISNULL(m002.盈利规划股权溢价单方, 0) +
            ISNULL(m002.盈利规划营销费用单方, 0) +
            ISNULL(m002.盈利规划综合管理费单方协议口径, 0) +
            ISNULL(m002.盈利规划税金及附加单方, 0)
        ) AS 业态所有支出的单方_含税费,

        -- 不含税成本
        -- 计算方式：业态所有支出的单方_含税费 * 已售面积
        (
            ISNULL(m002.盈利规划营业成本单方, 0) +
            ISNULL(m002.盈利规划股权溢价单方, 0) +
            ISNULL(m002.盈利规划营销费用单方, 0) +
            ISNULL(m002.盈利规划综合管理费单方协议口径, 0) +
            ISNULL(m002.盈利规划税金及附加单方, 0)
        ) * ISNULL(ld.已售面积, 0) /10000.0 AS 不含税成本,

        ld.已售净利润签约 /10000.0 AS 税后净利润,    -- 税后净利润 单位:亿元
        -- 销净率
        -- 若累计不含税签约金额为0，则销净率为0，否则为已售净利润签约/累计不含税签约金额
        CASE 
            WHEN ISNULL(累计不含税签约金额, 0) = 0 THEN 0
            ELSE ISNULL(ld.已售净利润签约, 0) / ISNULL(ld.累计不含税签约金额, 0)
        END *100 AS 销净率,    -- 销净率

        GETDATE() AS 清洗日期           -- 当前系统时间作为清洗日期
    FROM #ld ld
    left join #LastQyDate  lqy on ld.产品楼栋GUID = lqy.BldGUID
    left join [172.16.4.141].erp25.dbo.正常补货项目产品楼栋清单 bhqd on bhqd.SaleBldGUID = ld.产品楼栋GUID
    LEFT JOIN #M002 m002 
        ON ld.业态组合键 = m002.业态组合键      -- 以业态组合键和项目GUID进行关联
        AND ld.项目GUID = m002.ProjGUID
        and  ld.产品类型=m002.产品类型
        and  ld.产品名称=m002.产品名称   
        and  ld.商品类型 =m002.商品类型
        and  ld.装修标准=m002.装修标准

    /***********************************************************************
    步骤4：删除历史版本数据，保留关键快照
    说明：
        - 仅保留当天数据
        - 以及每周一、每月1号、每年最后一天、每月最后一天的快照
        - 其余超过7天的历史数据将被删除
        - 注意：此处“清洗时间”字段应为表中实际字段名，若为“清洗日期”请统一
    ***********************************************************************/
    DELETE FROM s_集团开工申请楼栋明细表智能体数据提取 
    WHERE 
        -- 1. 保留当天数据
        -- DATEDIFF(DAY, 清洗日期, GETDATE()) <> 0
        -- OR
        (
            -- 2. 保留以下特殊快照，其余超过7天的历史数据将被删除
            DATENAME(WEEKDAY, 清洗日期) <> '星期一'  -- 非周一
            AND DATEPART(DAY, 清洗日期) <> 1        -- 非每月1号
            AND DATEDIFF(DAY, 清洗日期, CONVERT(VARCHAR(4), YEAR(清洗日期)) + '-12-31') <> 0  -- 非每年最后一天
            AND DATEDIFF(DAY, 清洗日期, DATEADD(ms, -3, DATEADD(mm, DATEDIFF(m, 0, 清洗日期) + 1, 0))) <> 0 -- 非每月最后一天
            AND DATEDIFF(DAY, 清洗日期, GETDATE()) > 7  -- 距今超过7天
        );

    /***********************************************************************
    步骤5：查询当天数据，供后续分析或校验
    ***********************************************************************/
    SELECT  *
    FROM s_集团开工申请楼栋明细表智能体数据提取  
    WHERE DATEDIFF(DAY, 清洗日期, GETDATE()) = 0  
    ORDER BY 公司名称,项目名称,业态

    /***********************************************************************
    步骤6：删除临时表，释放资源
    ***********************************************************************/
    DROP TABLE #ld,#m002
END


-- CREATE TABLE [dbo].[data_wide_dws_qt_F05601](
-- 	[MdcDataGUID] [uniqueidentifier] NOT NULL,
-- 	[VersionNumber] [timestamp] NOT NULL,
-- 	[GCBldGUID] [uniqueidentifier] NULL,
-- 	[OrgGuid] [uniqueidentifier] NULL,
-- 	[SaleBldGUID] [uniqueidentifier] NULL,
-- 	[VersionGuid] [uniqueidentifier] NULL,
-- 	[ztguid] [uniqueidentifier] NULL,
-- 	[本年签约金额] [money] NULL,
-- 	[本年签约均价] [money] NULL,
-- 	[本年签约面积] [money] NULL,
-- 	[本年签约套数] [money] NULL,
-- 	[本年预计签约金额] [money] NULL,
-- 	[本年预计签约面积] [money] NULL,
-- 	[本月签约金额] [money] NULL,
-- 	[本月签约均价] [money] NULL,
-- 	[本月签约面积] [money] NULL,
-- 	[产品类型] [varchar](200) NULL,
-- 	[产品楼栋名称] [varchar](50) NULL,
-- 	[产品名称] [varchar](200) NULL,
-- 	[产值未付] [money] NULL,
-- 	[持有面积] [money] NULL,
-- 	[持有套数] [money] NULL,
-- 	[除地价外直投单方] [money] NULL,
-- 	[除地价外直投分摊金额] [money] NULL,
-- 	[达到预售形象的条件] [varchar](100) NULL,
-- 	[达到预售形象计划日期] [datetime] NULL,
-- 	[达到预售形象完成日期] [datetime] NULL,
-- 	[待发生产值] [decimal](38, 10) NULL,
-- 	[待售货值] [money] NULL,
-- 	[待售面积] [decimal](36, 8) NULL,
-- 	[待售套数] [money] NULL,
-- 	[地上层数] [int] NULL,
-- 	[地上建面] [money] NULL,
-- 	[地上可售面积] [decimal](38, 10) NULL,
-- 	[地上可售面积地上自持面积] [decimal](38, 10) NULL,
-- 	[地上自持面积] [decimal](38, 10) NULL,
-- 	[地下层数] [int] NULL,
-- 	[地下建面] [money] NULL,
-- 	[定位单价] [money] NULL,
-- 	[定位货值] [money] NULL,
-- 	[定位均价] [money] NULL,
-- 	[动态总货值] [money] NULL,
-- 	[分期名称] [varchar](50) NULL,
-- 	[工程楼栋名称] [varchar](40) NULL,
-- 	[股权溢价单方] [money] NULL,
-- 	[合同约定应付金额] [money] NULL,
-- 	[货量铺排均价计算方式] [varchar](200) NULL,
-- 	[货值铺排均价不含税] [money] NULL,
-- 	[获取时间] [datetime] NULL,
-- 	[集中交付计划日期] [date] NULL,
-- 	[集中交付完成日期] [date] NULL,
-- 	[计容面积] [decimal](38, 10) NULL,
-- 	[近六月签约金额不含税] [money] NULL,
-- 	[近六月签约金额均价不含税] [money] NULL,
-- 	[近六月签约面积] [money] NULL,
-- 	[近三月签约金额不含税] [money] NULL,
-- 	[近三月签约金额均价不含税] [money] NULL,
-- 	[近三月签约面积] [money] NULL,
-- 	[经营成本单方] [money] NULL,
-- 	[竣工备案计划日期] [datetime] NULL,
-- 	[竣工备案完成日期] [datetime] NULL,
-- 	[开发间接费单方] [money] NULL,
-- 	[可售面积] [decimal](38, 10) NULL,
-- 	[累计本年回笼金额] [decimal](38, 10) NULL,
-- 	[累计本月回笼金额] [decimal](38, 10) NULL,
-- 	[累计回笼金额] [decimal](38, 10) NULL,
-- 	[累计支付金额] [money] NULL,
-- 	[立项单价] [money] NULL,
-- 	[立项货值] [money] NULL,
-- 	[立项均价] [money] NULL,
-- 	[明源系统代码] [varchar](100) NULL,
-- 	[年初可售货值] [money] NULL,
-- 	[年初可售面积] [money] NULL,
-- 	[平台公司] [varchar](200) NULL,
-- 	[签约金额2024年] [money] NULL,
-- 	[签约均价2024年] [money] NULL,
-- 	[签约面积2024年] [money] NULL,
-- 	[签约套数2024年] [money] NULL,
-- 	[赛道图标签] [varchar](100) NULL,
-- 	[商品类型] [varchar](200) NULL,
-- 	[实际开工计划日期] [datetime] NULL,
-- 	[实际开工完成日期] [datetime] NULL,
-- 	[是否持有] [varchar](10) NULL,
-- 	[是否合作项目] [varchar](100) NULL,
-- 	[是否可售] [varchar](10) NULL,
-- 	[是否停工] [varchar](50) NULL,
-- 	[首开30天签约金额] [money] NULL,
-- 	[首开30天签约面积] [money] NULL,
-- 	[首开30天签约套数] [int] NULL,
-- 	[首开30天认购金额] [money] NULL,
-- 	[首开30天认购面积] [money] NULL,
-- 	[首开30天认购套数] [int] NULL,
-- 	[首开楼栋标签] [varchar](10) NULL,
-- 	[首推时间] [datetime] NULL,
-- 	[税金及附加单方] [money] NULL,
-- 	[土地分摊金额] [money] NULL,
-- 	[土地款单方] [money] NULL,
-- 	[未售对应总成本] [money] NULL,
-- 	[未售货值不含税] [money] NULL,
-- 	[未售净利润签约] [money] NULL,
-- 	[项目代码] [varchar](100) NULL,
-- 	[项目名称] [varchar](50) NULL,
-- 	[项目首推时间] [datetime] NULL,
-- 	[项目推广名] [varchar](50) NULL,
-- 	[项目未售税前利润签约] [money] NULL,
-- 	[项目已售税前利润签约] [money] NULL,
-- 	[项目整盘利润] [money] NULL,
-- 	[业态组合键] [varchar](200) NULL,
-- 	[已发生财务费用费用摊分金额] [money] NULL,
-- 	[已发生管理费用摊分金额] [money] NULL,
-- 	[已发生税金分摊] [money] NULL,
-- 	[已发生营销费用摊分金额] [money] NULL,
-- 	[已结转成本] [money] NULL,
-- 	[已结转面积] [money] NULL,
-- 	[已结转收入] [money] NULL,
-- 	[已结转套数] [money] NULL,
-- 	[已售对应总成本] [money] NULL,
-- 	[已售货值] [money] NULL,
-- 	[已售货值不含税] [money] NULL,
-- 	[已售净利润签约] [money] NULL,
-- 	[已售均价] [money] NULL,
-- 	[已售均价不含税] [money] NULL,
-- 	[已售面积] [decimal](36, 8) NULL,
-- 	[已售套数] [int] NULL,
-- 	[已完成产值] [money] NULL,
-- 	[应付未付] [money] NULL,
-- 	[营销费用单方] [money] NULL,
-- 	[营业成本单方] [money] NULL,
-- 	[用地面积] [decimal](38, 10) NULL,
-- 	[预测单价] [money] NULL,
-- 	[预售办理计划日期] [datetime] NULL,
-- 	[预售办理完成日期] [datetime] NULL,
-- 	[占压资金] [decimal](38, 10) NULL,
-- 	[整盘均价] [money] NULL,
-- 	[正式开工实际完成时间] [datetime] NULL,
-- 	[正式开工预计完成时间] [datetime] NULL,
-- 	[装修标准] [varchar](200) NULL,
-- 	[资本化利息单方] [money] NULL,
-- 	[自持可售面积] [decimal](38, 10) NULL,
-- 	[自持面积] [decimal](38, 10) NULL,
-- 	[综合管理费单方] [money] NULL,
-- 	[总产值] [decimal](38, 10) NULL,
-- 	[总成本不含税单方] [money] NULL,
-- 	[总地价] [money] NULL,
-- 	[总建面] [decimal](36, 8) NULL,
-- 	[总可售面积] [decimal](36, 8) NULL,
-- 	[总可售套数] [money] NULL,
-- PRIMARY KEY CLUSTERED 
-- (
-- 	[MdcDataGUID] ASC
-- )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
-- ) ON [PRIMARY]
-- GO
